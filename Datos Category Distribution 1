import json
import pandas as pd

with open('data_cat.json') as file:
    data=json.load(file)
data

{u'data': [{u'avg': 39.08693,
   u'cards': 101101,
   u'categories': [{u'avg': 26.62689,
     u'cards': 4689,
     u'id': u'es_transportation',
     u'merchants': 193,
     u'txs': 5391},
    {u'avg': 53.24407,
     u'cards': 1261,
     u'id': u'es_home',
     u'merchants': 49,
     u'txs': 1447},
    {u'avg': 23.06442,
     u'cards': 114,
     u'id': u'es_contents',
     u'merchants': 12,
     u'txs': 129},
    {u'avg': 286.78259,
     u'cards': 685,
     u'id': u'es_auto',
     u'merchants': 44,
     u'txs': 734},
    {u'avg': 22.10333,
     u'cards': 9183,
     u'id': u'es_barsandrestaurants',
     u'merchants': 161,
     u'txs': 14699},
    {u'avg': 52.78658,
     u'cards': 5268,
     u'id': u'es_health',
     u'merchants': 128,
     u'txs': 6395},
    {u'avg': 41.70763,
     u'cards': 8616,
     u'id': u'es_otherservices',
     u'merchants': 98,
     u'txs': 10573},
    {u'avg': 34.39595,
     u'cards': 56423,
     u'id': u'es_fashion',
     u'merchants': 137,
     u'txs': 83442},
    {u'avg': 41.40333,
     u'cards': 4061,
     u'id': u'es_sportsandtoys',
     u'merchants': 24,
     u'txs': 4338},
    {u'avg': 543.92112,
     u'cards': 49,
     u'id': u'es_travel',
     u'merchants': 11,
     u'txs': 116},
    {u'avg': 38.56464,
     u'cards': 6549,
     u'id': u'es_food',
     u'merchants': 129,
     u'txs': 11746},
    {u'avg': 81.63306,
     u'cards': 4881,
     u'id': u'es_tech',
     u'merchants': 51,
     u'txs': 5325},
    {u'avg': 41.38773, u'id': u'filtered', u'txs': 45054}],
   u'date': u'201501',
   u'merchants': 1174,
   u'txs': 189389},
  {u'avg': 39.77718,
   u'cards': 76401,
   u'categories': [{u'avg': 41.04718,
     u'cards': 6957,
     u'id': u'es_otherservices',
     u'merchants': 94,
     u'txs': 8422},
    {u'avg': 37.74877,
     u'cards': 6141,
     u'id': u'es_food',
     u'merchants': 128,
     u'txs': 10911},
    {u'avg': 27.80341,
     u'cards': 84,
     u'id': u'es_contents',
     u'merchants': 15,
     u'txs': 91},
    {u'avg': 53.47596,
     u'cards': 5070,
     u'id': u'es_health',
     u'merchants': 123,
     u'txs': 6141},
    {u'avg': 32.83976,
     u'cards': 34850,
     u'id': u'es_fashion',
     u'merchants': 136,
     u'txs': 47570},
    {u'avg': 275.95993,
     u'cards': 709,
     u'id': u'es_auto',
     u'merchants': 50,
     u'txs': 757},
    {u'avg': 62.70933,
     u'cards': 925,
     u'id': u'es_home',
     u'merchants': 49,
     u'txs': 1039},
    {u'avg': 84.42398,
     u'cards': 3285,
     u'id': u'es_tech',
     u'merchants': 51,
     u'txs': 3679},
    {u'avg': 38.89263,
     u'cards': 2629,
     u'id': u'es_sportsandtoys',
     u'merchants': 25,
     u'txs': 2821},
    {u'avg': 20.682,
     u'cards': 8957,
     u'id': u'es_barsandrestaurants',
     u'merchants': 169,
     u'txs': 14683},
    {u'avg': 26.1545,
     u'cards': 5121,
     u'id': u'es_transportation',
     u'merchants': 198,
     u'txs': 5919},
    {u'avg': 47.11577, u'id': u'filtered', u'txs': 34754}],
   u'date': u'201502',
   u'merchants': 1187,
   u'txs': 136787},
  {u'avg': 40.88516,
   u'cards': 84473,
   u'categories': [{u'avg': 42.26644,
     u'cards': 7690,
     u'id': u'es_otherservices',
     u'merchants': 99,
     u'txs': 9501},
    {u'avg': 39.73673,
     u'cards': 3004,
     u'id': u'es_sportsandtoys',
     u'merchants': 23,
     u'txs': 3222},
    {u'avg': 49.21568,
     u'cards': 5690,
     u'id': u'es_health',
     u'merchants': 133,
     u'txs': 6994},
    {u'avg': 289.84061,
     u'cards': 807,
     u'id': u'es_auto',
     u'merchants': 48,
     u'txs': 848},
    {u'avg': 22.87068,
     u'cards': 113,
     u'id': u'es_contents',
     u'merchants': 12,
     u'txs': 132},
    {u'avg': 73.01504,
     u'cards': 914,
     u'id': u'es_home',
     u'merchants': 55,
     u'txs': 1048},
    {u'avg': 36.52078,
     u'cards': 6618,
     u'id': u'es_food',
     u'merchants': 130,
     u'txs': 11871},
    {u'avg': 25.57507,
     u'cards': 5832,
     u'id': u'es_transportation',
     u'merchants': 198,
     u'txs': 6781},
    {u'avg': 83.95479,
     u'cards': 3548,
     u'id': u'es_tech',
     u'merchants': 56,
     u'txs': 3952},
    {u'avg': 21.44585,
     u'cards': 9897,
     u'id': u'es_barsandrestaurants',
     u'merchants': 166,
     u'txs': 16212},
    {u'avg': 36.92559,
     u'cards': 39443,
     u'id': u'es_fashion',
     u'merchants': 133,
     u'txs': 55379},
    {u'avg': 46.27422, u'id': u'filtered', u'txs': 38921}],
   u'date': u'201503',
   u'merchants': 1197,
   u'txs': 154861},
  {u'avg': 40.40019,
   u'cards': 83156,
   u'categories': [{u'avg': 292.28665,
     u'cards': 718,
     u'id': u'es_auto',
     u'merchants': 50,
     u'txs': 767},
    {u'avg': 68.78547,
     u'cards': 861,
     u'id': u'es_home',
     u'merchants': 51,
     u'txs': 951},
    {u'avg': 24.63379,
     u'cards': 109,
     u'id': u'es_contents',
     u'merchants': 10,
     u'txs': 132},
    {u'avg': 25.35088,
     u'cards': 5463,
     u'id': u'es_transportation',
     u'merchants': 196,
     u'txs': 6396},
    {u'avg': 36.69663,
     u'cards': 6420,
     u'id': u'es_food',
     u'merchants': 128,
     u'txs': 11262},
    {u'avg': 43.36764,
     u'cards': 2871,
     u'id': u'es_sportsandtoys',
     u'merchants': 24,
     u'txs': 3078},
    {u'avg': 87.84312,
     u'cards': 2978,
     u'id': u'es_tech',
     u'merchants': 51,
     u'txs': 3329},
    {u'avg': 52.59989,
     u'cards': 5281,
     u'id': u'es_health',
     u'merchants': 134,
     u'txs': 6448},
    {u'avg': 20.24892,
     u'cards': 9115,
     u'id': u'es_barsandrestaurants',
     u'merchants': 169,
     u'txs': 15543},
    {u'avg': 41.11119,
     u'cards': 7622,
     u'id': u'es_otherservices',
     u'merchants': 97,
     u'txs': 9281},
    {u'avg': 36.66283,
     u'cards': 40320,
     u'id': u'es_fashion',
     u'merchants': 138,
     u'txs': 55872},
    {u'avg': 45.46977, u'id': u'filtered', u'txs': 37389}],
   u'date': u'201504',
   u'merchants': 1186,
   u'txs': 150448},
  {u'avg': 40.72471,
   u'cards': 90816,
   u'categories': [{u'avg': 293.28875,
     u'cards': 802,
     u'id': u'es_auto',
     u'merchants': 49,
     u'txs': 835},
    {u'avg': 40.78008,
     u'cards': 3150,
     u'id': u'es_sportsandtoys',
     u'merchants': 25,
     u'txs': 3410},
    {u'avg': 30.11874,
     u'cards': 102,
     u'id': u'es_contents',
     u'merchants': 14,
     u'txs': 111},
    {u'avg': 75.2736,
     u'cards': 3115,
     u'id': u'es_tech',
     u'merchants': 45,
     u'txs': 3418},
    {u'avg': 50.29282,
     u'cards': 5934,
     u'id': u'es_health',
     u'merchants': 129,
     u'txs': 7389},
    {u'avg': 36.34713,
     u'cards': 45694,
     u'id': u'es_fashion',
     u'merchants': 137,
     u'txs': 64511},
    {u'avg': 25.8122,
     u'cards': 6156,
     u'id': u'es_transportation',
     u'merchants': 202,
     u'txs': 7205},
    {u'avg': 20.49819,
     u'cards': 9576,
     u'id': u'es_barsandrestaurants',
     u'merchants': 168,
     u'txs': 16293},
    {u'avg': 40.68498,
     u'cards': 8434,
     u'id': u'es_otherservices',
     u'merchants': 103,
     u'txs': 10462},
    {u'avg': 36.81064,
     u'cards': 6561,
     u'id': u'es_food',
     u'merchants': 134,
     u'txs': 11886},
    {u'avg': 66.56245,
     u'cards': 924,
     u'id': u'es_home',
     u'merchants': 54,
     u'txs': 1048},
    {u'avg': 48.74772, u'id': u'filtered', u'txs': 42449}],
   u'date': u'201505',
   u'merchants': 1199,
   u'txs': 169017},
  {u'avg': 40.96622,
   u'cards': 92145,
   u'categories': [{u'avg': 295.76563,
     u'cards': 903,
     u'id': u'es_auto',
     u'merchants': 49,
     u'txs': 947},
    {u'avg': 35.98743,
     u'cards': 6761,
     u'id': u'es_food',
     u'merchants': 131,
     u'txs': 11762},
    {u'avg': 34.126,
     u'cards': 45255,
     u'id': u'es_fashion',
     u'merchants': 144,
     u'txs': 62785},
    {u'avg': 26.16118,
     u'cards': 6121,
     u'id': u'es_transportation',
     u'merchants': 203,
     u'txs': 7085},
    {u'avg': 38.2641,
     u'cards': 3530,
     u'id': u'es_sportsandtoys',
     u'merchants': 25,
     u'txs': 3808},
    {u'avg': 32.83566,
     u'cards': 96,
     u'id': u'es_contents',
     u'merchants': 13,
     u'txs': 113},
    {u'avg': 54.35507,
     u'cards': 5683,
     u'id': u'es_health',
     u'merchants': 137,
     u'txs': 6967},
    {u'avg': 19.16952,
     u'cards': 10036,
     u'id': u'es_barsandrestaurants',
     u'merchants': 163,
     u'txs': 16801},
    {u'avg': 77.96468,
     u'cards': 3519,
     u'id': u'es_tech',
     u'merchants': 51,
     u'txs': 3859},
    {u'avg': 39.76594,
     u'cards': 8554,
     u'id': u'es_otherservices',
     u'merchants': 108,
     u'txs': 10450},
    {u'avg': 66.94427,
     u'cards': 1085,
     u'id': u'es_home',
     u'merchants': 58,
     u'txs': 1216},
    {u'avg': 51.79827, u'id': u'filtered', u'txs': 43753}],
   u'date': u'201506',
   u'merchants': 1224,
   u'txs': 169546},
  {u'avg': 39.56326,
   u'cards': 96153,
   u'categories': [{u'avg': 76.61206,
     u'cards': 3482,
     u'id': u'es_tech',
     u'merchants': 49,
     u'txs': 3843},
    {u'avg': 37.44253,
     u'cards': 3710,
     u'id': u'es_sportsandtoys',
     u'merchants': 26,
     u'txs': 3935},
    {u'avg': 41.45361,
     u'cards': 8697,
     u'id': u'es_otherservices',
     u'merchants': 107,
     u'txs': 10892},
    {u'avg': 20.66366,
     u'cards': 9796,
     u'id': u'es_barsandrestaurants',
     u'merchants': 166,
     u'txs': 14003},
    {u'avg': 58.0696,
     u'cards': 5786,
     u'id': u'es_health',
     u'merchants': 143,
     u'txs': 6951},
    {u'avg': 28.95888,
     u'cards': 5714,
     u'id': u'es_transportation',
     u'merchants': 201,
     u'txs': 6623},
    {u'avg': 65.15456,
     u'cards': 115,
     u'id': u'es_contents',
     u'merchants': 12,
     u'txs': 125},
    {u'avg': 30.28823,
     u'cards': 49925,
     u'id': u'es_fashion',
     u'merchants': 142,
     u'txs': 73243},
    {u'avg': 275.60011,
     u'cards': 999,
     u'id': u'es_auto',
     u'merchants': 50,
     u'txs': 1068},
    {u'avg': 62.22466,
     u'cards': 1085,
     u'id': u'es_home',
     u'merchants': 53,
     u'txs': 1211},
    {u'avg': 34.7917,
     u'cards': 6110,
     u'id': u'es_food',
     u'merchants': 129,
     u'txs': 10330},
    {u'avg': 50.53409, u'id': u'filtered', u'txs': 45349}],
   u'date': u'201507',
   u'merchants': 1225,
   u'txs': 177573},
  {u'avg': 39.19452,
   u'cards': 68607,
   u'categories': [{u'avg': 42.09625,
     u'cards': 7490,
     u'id': u'es_otherservices',
     u'merchants': 89,
     u'txs': 9044},
    {u'avg': 53.82411,
     u'cards': 811,
     u'id': u'es_home',
     u'merchants': 38,
     u'txs': 951},
    {u'avg': 30.8562,
     u'cards': 4685,
     u'id': u'es_food',
     u'merchants': 118,
     u'txs': 7439},
    {u'avg': 138.83621,
     u'cards': 128,
     u'id': u'es_contents',
     u'merchants': 13,
     u'txs': 140},
    {u'avg': 259.56555,
     u'cards': 653,
     u'id': u'es_auto',
     u'merchants': 40,
     u'txs': 687},
    {u'avg': 37.95627,
     u'cards': 2637,
     u'id': u'es_sportsandtoys',
     u'merchants': 20,
     u'txs': 2786},
    {u'avg': 20.26201,
     u'cards': 7124,
     u'id': u'es_barsandrestaurants',
     u'merchants': 155,
     u'txs': 9606},
    {u'avg': 48.42008,
     u'cards': 4352,
     u'id': u'es_health',
     u'merchants': 117,
     u'txs': 5136},
    {u'avg': 31.71281,
     u'cards': 30139,
     u'id': u'es_fashion',
     u'merchants': 132,
     u'txs': 39765},
    {u'avg': 74.72697,
     u'cards': 2853,
     u'id': u'es_tech',
     u'merchants': 46,
     u'txs': 3117},
    {u'avg': 30.03345,
     u'cards': 3140,
     u'id': u'es_transportation',
     u'merchants': 185,
     u'txs': 3613},
    {u'avg': 45.21852, u'id': u'filtered', u'txs': 35577}],
   u'date': u'201508',
   u'merchants': 1089,
   u'txs': 117861},
  {u'avg': 42.49815,
   u'cards': 82612,
   u'categories': [{u'avg': 77.57567,
     u'cards': 952,
     u'id': u'es_home',
     u'merchants': 50,
     u'txs': 1075},
    {u'avg': 21.55787,
     u'cards': 9067,
     u'id': u'es_barsandrestaurants',
     u'merchants': 173,
     u'txs': 12809},
    {u'avg': 43.43334,
     u'cards': 3757,
     u'id': u'es_sportsandtoys',
     u'merchants': 29,
     u'txs': 4041},
    {u'avg': 39.23306,
     u'cards': 36406,
     u'id': u'es_fashion',
     u'merchants': 143,
     u'txs': 49574},
    {u'avg': 79.65439,
     u'cards': 3788,
     u'id': u'es_tech',
     u'merchants': 49,
     u'txs': 4163},
    {u'avg': 82.65498,
     u'cards': 414,
     u'id': u'es_contents',
     u'merchants': 13,
     u'txs': 528},
    {u'avg': 25.24854,
     u'cards': 5480,
     u'id': u'es_transportation',
     u'merchants': 195,
     u'txs': 6287},
    {u'avg': 54.24058,
     u'cards': 5158,
     u'id': u'es_health',
     u'merchants': 134,
     u'txs': 6274},
    {u'avg': 45.02629,
     u'cards': 8026,
     u'id': u'es_otherservices',
     u'merchants': 107,
     u'txs': 9895},
    {u'avg': 35.56877,
     u'cards': 7263,
     u'id': u'es_food',
     u'merchants': 131,
     u'txs': 13121},
    {u'avg': 296.05622,
     u'cards': 772,
     u'id': u'es_auto',
     u'merchants': 52,
     u'txs': 825},
    {u'avg': 45.17696, u'id': u'filtered', u'txs': 38902}],
   u'date': u'201509',
   u'merchants': 1222,
   u'txs': 147494},
  {u'avg': 42.32341,
   u'cards': 90908,
   u'categories': [{u'avg': 81.95402,
     u'cards': 3420,
     u'id': u'es_tech',
     u'merchants': 52,
     u'txs': 3737},
    {u'avg': 22.63871,
     u'cards': 10065,
     u'id': u'es_barsandrestaurants',
     u'merchants': 178,
     u'txs': 14397},
    {u'avg': 42.57658,
     u'cards': 3743,
     u'id': u'es_sportsandtoys',
     u'merchants': 28,
     u'txs': 3981},
    {u'avg': 63.73694,
     u'cards': 1092,
     u'id': u'es_home',
     u'merchants': 54,
     u'txs': 1246},
    {u'avg': 34.8846,
     u'cards': 7476,
     u'id': u'es_food',
     u'merchants': 134,
     u'txs': 14063},
    {u'avg': 54.45414,
     u'cards': 5373,
     u'id': u'es_health',
     u'merchants': 134,
     u'txs': 6556},
    {u'avg': 23.997,
     u'cards': 6426,
     u'id': u'es_transportation',
     u'merchants': 200,
     u'txs': 7332},
    {u'avg': 31.98831,
     u'cards': 232,
     u'id': u'es_contents',
     u'merchants': 14,
     u'txs': 261},
    {u'avg': 271.41777,
     u'cards': 822,
     u'id': u'es_auto',
     u'merchants': 53,
     u'txs': 865},
    {u'avg': 40.8743,
     u'cards': 9030,
     u'id': u'es_otherservices',
     u'merchants': 110,
     u'txs': 11165},
    {u'avg': 40.32121,
     u'cards': 42443,
     u'id': u'es_fashion',
     u'merchants': 143,
     u'txs': 58985},
    {u'avg': 47.39145, u'id': u'filtered', u'txs': 40622}],
   u'date': u'201510',
   u'merchants': 1247,
   u'txs': 163210}],
 u'result': {u'code': 200, u'info': u'OK'}}
 
 fecha=[]
cat=[]
cards=[]
avg=[]
merch=[]
txs=[]

for i in range(len(data['data'])):
    #fecha.append(data['data'][i]['date'])
    for a in range(len(data['data'][i]['categories'])):
        fecha.append(data['data'][i]['date'])
        cat.append(data['data'][i]['categories'][a]['id'])
        if (data['data'][i]['categories'][a]['id']=='filtered'):
            cards.append(0)
        else:
            cards.append(data['data'][i]['categories'][a]['cards'])
        avg.append(data['data'][i]['categories'][a]['avg'])
        if (data['data'][i]['categories'][a]['id']=='filtered'):
            merch.append(0)
        else:
            merch.append(data['data'][i]['categories'][a]['merchants'])
        txs.append(data['data'][i]['categories'][a]['txs'])
        
        
        
        
        
d_cat = pd.DataFrame()
d_cat['Fecha']=fecha
d_cat['Categoria']=cat
d_cat['Nº Tarjetas']=cards
d_cat['Compra Media']=avg
d_cat['Establecimientos']=merch
d_cat['Txs']=txs
d_cat


